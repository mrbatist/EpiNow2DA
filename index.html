<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Estimates the time-varying reproduction number,
    rate of spread, and doubling time using a range of open-source tools
    (Abbott et al. (2020) &lt;doi:10.12688/wellcomeopenres.16006.1&gt;), and
    current best practices (Gostic et al. (2020)
    &lt;doi:10.1101/2020.06.18.20134858&gt;).  It aims to help users avoid some
    of the limitations of naive implementations in a framework that is
    informed by community feedback and is actively supported.">
<title>Estimate Real-Time Case Counts and Time-Varying
    Epidemiological Parameters • EpiNow2</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Estimate Real-Time Case Counts and Time-Varying
    Epidemiological Parameters">
<meta property="og:description" content="Estimates the time-varying reproduction number,
    rate of spread, and doubling time using a range of open-source tools
    (Abbott et al. (2020) &lt;doi:10.12688/wellcomeopenres.16006.1&gt;), and
    current best practices (Gostic et al. (2020)
    &lt;doi:10.1101/2020.06.18.20134858&gt;).  It aims to help users avoid some
    of the limitations of naive implementations in a framework that is
    informed by community feedback and is actively supported.">
<meta property="og:image" content="epiforecasts.io/EpiNow2/reference/figures/unnamed-chunk-14-1.png">
<meta property="og:image:alt" content="Example estimates produced by EpiNow2 of the reproduction number, cases by date of infection and cases by date of report">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@seabbs">
<meta name="twitter:site" content="@cmmid_lshtm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">EpiNow2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-model-definitions">Model definitions</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-model-definitions">
    <a class="dropdown-item" href="articles/estimate_infections.html">estimate_infections()</a>
    <a class="dropdown-item" href="articles/estimate_secondary.html">estimate_secondary()</a>
    <a class="dropdown-item" href="articles/estimate_truncation.html">estimate_truncation()</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-studies">Case studies</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-studies">
    <a class="dropdown-item" href="articles/case-studies.html">External case studies and use in the literature</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiforecasts/EpiNow2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters">EpiNow2: Estimate real-time case counts and time-varying epidemiological parameters<a class="anchor" aria-label="anchor" href="#epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters"></a>
</h1></div>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a> <a href="https://github.com/epiforecasts/EpiNow2/actions" class="external-link"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://codecov.io/gh/epiforecasts/EpiNow2" class="external-link"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/main/graph/badge.svg?token=FZWwEMdpq6" alt="codecov"></a> <a href="https://cran.r-project.org/package=EpiNow2" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/EpiNow2?color=ff69b4" alt="metacran downloads"></a></p>
<p><a href="https://github.com/epiforecasts/EpiNow2/blob/main/LICENSE.md/" class="external-link"><img src="https://img.shields.io/badge/License-MIT-blue.svg" alt="MIT license"></a> <a href="https://github.com/epiforecasts/EpiNow2/graphs/contributors" class="external-link"><img src="https://img.shields.io/github/contributors/epiforecasts/EpiNow2" alt="GitHub contributors"></a> <a href="https://epiforecasts.r-universe.dev/ui#package:EpiNow2" class="external-link"><img src="https://epiforecasts.r-universe.dev/badges/EpiNow2" alt="universe"></a> <a href="https://GitHub.com/epiforecasts/EpiNow2/commit/main/" class="external-link"><img src="https://img.shields.io/github/commits-since/epiforecasts/EpiNow2/v1.34.svg?color=orange" alt="GitHub commits"></a> <a href="https://zenodo.org/badge/latestdoi/272995211" class="external-link"><img src="https://zenodo.org/badge/272995211.svg" alt="DOI"></a></p>
<p>This package estimates the time-varying reproduction number, growth rate, and doubling time using a range of open-source tools (<a href="https://doi.org/10.12688/wellcomeopenres.16006.1" class="external-link">Abbott et al.</a>), and current best practices (<a href="https://doi.org/10.1371/journal.pcbi.1008409" class="external-link">Gostic et al.</a>). It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is actively supported.</p>
<p>It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in <a href="https://github.com/mrc-ide/EpiEstim" class="external-link"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in the examples in the package documentation these are an incubation period and a reporting delay) and a reporting model that can include weekly periodicity.</p>
<p>Uncertainty is propagated from all inputs into the final parameter estimates, helping to mitigate spurious findings. This is handled internally. The time-varying reproduction estimates and the uncertain generation time also give time-varying estimates of the rate of growth.</p>
<p>The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number and then infer infections. Other options include:</p>
<ul>
<li>A stationary Gaussian process (faster to estimate but currently gives reduced performance for real time estimates).</li>
<li>User specified breakpoints.</li>
<li>A fixed reproduction number.</li>
<li>As piecewise constant by combining a fixed reproduction number with breakpoints.</li>
<li>As a random walk (by combining a fixed reproduction number with regularly spaced breakpoints (i.e weekly)).</li>
<li>Inferring infections using back-calculation and then calculating the time-varying reproduction number.</li>
<li>Adjustment for the remaining susceptible population beyond the forecast horizon.</li>
</ul>
<p>These options generally reduce runtimes at the cost of the granularity of estimates or at the cost of real-time performance.</p>
<p>The documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> provides examples of the implementation of the different options available.</p>
<p>Forecasting is also supported for the time-varying reproduction number, infections and reported cases using the same generative process approach as used for estimation.</p>
<p>A simple example of using the package to estimate a national Rt for Covid-19 can be found <a href="https://gist.github.com/seabbs/163d0f195892cde685c70473e1f5e867" class="external-link">here</a>.</p>
<p><code>EpiNow2</code> also supports adjustment for truncated data via <code><a href="reference/estimate_truncation.html">estimate_truncation()</a></code> (though users may be interested in more flexibility and if so should check out the <a href="https://package.epinowcast.org/" class="external-link"><code>epinowcast</code></a> package), and for estimating dependent observations (i.e deaths based on hospital admissions) using <code><a href="reference/estimate_secondary.html">estimate_secondary()</a></code>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the stable version of the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"EpiNow2"</span><span class="op">)</span></span></code></pre></div>
<p>Install the stable development version of the package with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"EpiNow2"</span>, repos <span class="op">=</span> <span class="st">"https://epiforecasts.r-universe.dev"</span><span class="op">)</span></span></code></pre></div>
<p>Install the unstable development version of the package with (few users should need to do this):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"epiforecasts/EpiNow2"</span><span class="op">)</span></span></code></pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain" class="external-link">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modelling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker" class="external-link">here</a>).</p>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p><a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. The core functions of <a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a> are the two single-call functions <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow()</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html"><code>regional_epinow()</code></a>, plus functions <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections()</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_secondary.html"><code>estimate_secondary()</code></a> and <a href="https://epiforecasts.io/EpiNow2/reference/estimate_truncation.html"><code>estimate_truncation()</code></a>. In the following section we give an overview of the simple use case for <code>epinow</code> and <code>regional_epinow</code>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections()</code></a> can be used on its own to infer the underlying infection case curve from reported cases and estimate Rt. Estimating the underlying infection case curve via back-calculation (and then calculating Rt) is substantially less computationally demanding than generating using default settings but may result in less reliable estimates of Rt. For more details on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>.</p>
<p>The first step to using the package is to load it as follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="reporting-delays-incubation-period-and-generation-time">Reporting delays, incubation period and generation time<a class="anchor" aria-label="anchor" href="#reporting-delays-incubation-period-and-generation-time"></a>
</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<p>For example if data on the delay between onset and infection was available we could fit a distribution to it with appropriate uncertainty as follows (note this is a synthetic example),</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reporting_delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimate_delay.html">estimate_delay</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  max_value <span class="op">=</span> <span class="fl">15</span>, bootstraps <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If data was not available we could instead make an informed estimate of the likely delay (note this is a synthetic example and not applicable to real world use cases),</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reporting_delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu"><a href="reference/convert_to_logmean.html">convert_to_logmean</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mean_sd <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu"><a href="reference/convert_to_logsd.html">convert_to_logsd</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, sd_sd <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow2/tree/main/data-raw" class="external-link">here</a> for the code that generates these estimates). Note that these distributions may not be applicable for your use case.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">generation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_generation_time.html">get_generation_time</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"SARS-CoV-2"</span>, source <span class="op">=</span> <span class="st">"ganyani"</span>, max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="va">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_incubation_period.html">get_incubation_period</a></span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"SARS-CoV-2"</span>, source <span class="op">=</span> <span class="st">"lauer"</span>, max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="epinow">
<a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow()</a><a class="anchor" aria-label="anchor" href="#epinow"></a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above.</p>
<p>Load example case data from <a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reported_cases</span><span class="op">)</span></span>
<span><span class="co">#&gt;          date confirm</span></span>
<span><span class="co">#&gt;        &lt;Date&gt;   &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 2020-02-22      14</span></span>
<span><span class="co">#&gt; 2: 2020-02-23      62</span></span>
<span><span class="co">#&gt; 3: 2020-02-24      53</span></span>
<span><span class="co">#&gt; 4: 2020-02-25      97</span></span>
<span><span class="co">#&gt; 5: 2020-02-26      93</span></span>
<span><span class="co">#&gt; 6: 2020-02-27      78</span></span></code></pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). Here we use the default model parameterisation that prioritises real-time performance over run-time or other considerations. For other formulations see the documentation for <code><a href="reference/estimate_infections.html">estimate_infections()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/epinow.html">epinow</a></span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="va">generation_time</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">incubation_period</span>, <span class="va">reporting_delay</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="fu"><a href="reference/stan_opts.html">stan_opts</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">4</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; DEBUG [2023-01-18 21:43:36] epinow: Running in exact mode for 2000 samples (across 4 chains each with a warm up of 250 iterations each) and 74 time steps of which 7 are a forecast</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span></span>
<span><span class="co">#&gt; [3] "summary"                  "plots"                   </span></span>
<span><span class="co">#&gt; [5] "timing"</span></span></code></pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format which can be accessed using <code>summary</code>. The default is to return a summary table of estimates for key parameters at the latest date partially supported by data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="reference/summary.epinow.html">summary</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">measure</th>
<th align="left">estimate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">New confirmed cases by infection date</td>
<td align="left">2155 (1068 – 3879)</td>
</tr>
<tr class="even">
<td align="left">Expected change in daily cases</td>
<td align="left">Likely decreasing</td>
</tr>
<tr class="odd">
<td align="left">Effective reproduction no.</td>
<td align="left">0.86 (0.6 – 1.1)</td>
</tr>
<tr class="even">
<td align="left">Rate of growth</td>
<td align="left">-0.04 (-0.12 – 0.035)</td>
</tr>
<tr class="odd">
<td align="left">Doubling/halving time (days)</td>
<td align="left">-17 (20 – -5.8)</td>
</tr>
</tbody>
</table>
<p>Summarised parameter estimates can also easily be returned, either filtered for a single parameter or for all parameters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="reference/summary.epinow.html">summary</a></span><span class="op">(</span><span class="va">estimates</span>, type <span class="op">=</span> <span class="st">"parameters"</span>, params <span class="op">=</span> <span class="st">"R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          date variable  strat     type   median     mean</span></span>
<span><span class="co">#&gt;        &lt;Date&gt;   &lt;char&gt; &lt;char&gt;   &lt;char&gt;    &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 2020-02-25        R   &lt;NA&gt; estimate 2.065829 2.072397</span></span>
<span><span class="co">#&gt; 2: 2020-02-26        R   &lt;NA&gt; estimate 2.028341 2.032065</span></span>
<span><span class="co">#&gt; 3: 2020-02-27        R   &lt;NA&gt; estimate 1.988446 1.991100</span></span>
<span><span class="co">#&gt; 4: 2020-02-28        R   &lt;NA&gt; estimate 1.949131 1.949639</span></span>
<span><span class="co">#&gt; 5: 2020-02-29        R   &lt;NA&gt; estimate 1.907343 1.907810</span></span>
<span><span class="co">#&gt; 6: 2020-03-01        R   &lt;NA&gt; estimate 1.865667 1.865723</span></span>
<span><span class="co">#&gt;            sd lower_90 lower_50 lower_20 upper_20 upper_50</span></span>
<span><span class="co">#&gt;         &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 0.12685720 1.873162 1.987449 2.036753 2.100213 2.152940</span></span>
<span><span class="co">#&gt; 2: 0.10264874 1.865377 1.963180 2.004094 2.055362 2.099367</span></span>
<span><span class="co">#&gt; 3: 0.08384514 1.855377 1.933914 1.969500 2.011835 2.047998</span></span>
<span><span class="co">#&gt; 4: 0.07003120 1.837577 1.900835 1.932157 1.966650 1.998166</span></span>
<span><span class="co">#&gt; 5: 0.06045323 1.810256 1.868194 1.893597 1.922287 1.948232</span></span>
<span><span class="co">#&gt; 6: 0.05407338 1.774314 1.832062 1.853145 1.878255 1.900403</span></span>
<span><span class="co">#&gt;    upper_90</span></span>
<span><span class="co">#&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 2.288921</span></span>
<span><span class="co">#&gt; 2: 2.203336</span></span>
<span><span class="co">#&gt; 3: 2.131155</span></span>
<span><span class="co">#&gt; 4: 2.063657</span></span>
<span><span class="co">#&gt; 5: 2.005690</span></span>
<span><span class="co">#&gt; 6: 1.955251</span></span></code></pre></div>
<p>Reported cases are returned in a separate data frame in order to streamline the reporting of forecasts and for model evaluation.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="reference/summary.epinow.html">summary</a></span><span class="op">(</span><span class="va">estimates</span>, output <span class="op">=</span> <span class="st">"estimated_reported_cases"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          date   type median     mean       sd lower_90 lower_50</span></span>
<span><span class="co">#&gt;        &lt;Date&gt; &lt;char&gt;  &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 2020-02-25  gp_rt    135 137.4510 30.71554    93.00      115</span></span>
<span><span class="co">#&gt; 2: 2020-02-26  gp_rt    123 124.8070 27.21185    83.00      106</span></span>
<span><span class="co">#&gt; 3: 2020-02-27  gp_rt    142 144.1400 31.78009    96.95      122</span></span>
<span><span class="co">#&gt; 4: 2020-02-28  gp_rt    191 195.2790 42.70302   131.00      165</span></span>
<span><span class="co">#&gt; 5: 2020-02-29  gp_rt    211 213.9030 46.34714   142.95      183</span></span>
<span><span class="co">#&gt; 6: 2020-03-01  gp_rt    286 290.6265 60.58639   199.00      249</span></span>
<span><span class="co">#&gt;    lower_20 upper_20 upper_50 upper_90</span></span>
<span><span class="co">#&gt;       &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      127    143.0      156   189.00</span></span>
<span><span class="co">#&gt; 2:      116    129.4      142   176.00</span></span>
<span><span class="co">#&gt; 3:      134    150.0      163   200.00</span></span>
<span><span class="co">#&gt; 4:      181    203.0      222   271.05</span></span>
<span><span class="co">#&gt; 5:      199    223.0      244   297.00</span></span>
<span><span class="co">#&gt; 6:      271    302.0      330   397.00</span></span></code></pre></div>
<p>A range of plots are returned (with the single summary plot shown below). These plots can also be generated using the following <code>plot</code> method.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot.estimate_infections.html">plot</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-14-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="regional_epinow">
<a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">regional_epinow()</a><a class="anchor" aria-label="anchor" href="#regional_epinow"></a>
</h3>
<p>The <code><a href="reference/regional_epinow.html">regional_epinow()</a></code> function runs the <code><a href="reference/epinow.html">epinow()</a></code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">reported_cases</span><span class="op">)</span><span class="op">[</span>, <span class="va">region</span> <span class="op">:=</span> <span class="st">"testland"</span><span class="op">]</span>,</span>
<span>  <span class="va">reported_cases</span><span class="op">[</span>, <span class="va">region</span> <span class="op">:=</span> <span class="st">"realland"</span><span class="op">]</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reported_cases</span><span class="op">)</span></span>
<span><span class="co">#&gt;          date confirm   region</span></span>
<span><span class="co">#&gt;        &lt;Date&gt;   &lt;num&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: 2020-02-22      14 testland</span></span>
<span><span class="co">#&gt; 2: 2020-02-23      62 testland</span></span>
<span><span class="co">#&gt; 3: 2020-02-24      53 testland</span></span>
<span><span class="co">#&gt; 4: 2020-02-25      97 testland</span></span>
<span><span class="co">#&gt; 5: 2020-02-26      93 testland</span></span>
<span><span class="co">#&gt; 6: 2020-02-27      78 testland</span></span></code></pre></div>
<p>Calling <code><a href="reference/regional_epinow.html">regional_epinow()</a></code> runs the <code><a href="reference/epinow.html">epinow()</a></code> on each region in turn (or in parallel depending on the settings used). Here we switch to using a weekly random walk rather than the full Gaussian process model giving us piecewise constant estimates by week.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span><span class="op">(</span></span>
<span>  reported_cases <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="va">generation_time</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu"><a href="reference/delay_opts.html">delay_opts</a></span><span class="op">(</span><span class="va">incubation_period</span>, <span class="va">reporting_delay</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="fu"><a href="reference/rt_opts.html">rt_opts</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, rw <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>  gp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stan <span class="op">=</span> <span class="fu"><a href="reference/stan_opts.html">stan_opts</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">4</span>, warmup <span class="op">=</span> <span class="fl">250</span>, samples <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:04] Producing following optional outputs: regions, summary, samples, plots, latest</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:04] Reporting estimates using data up to: 2020-04-21</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:04] No target directory specified so returning output</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:04] Producing estimates for: testland, realland</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:04] Regions excluded: none</span></span>
<span><span class="co">#&gt; DEBUG [2023-01-18 21:47:04] testland: Running in exact mode for 1000 samples (across 4 chains each with a warm up of 250 iterations each) and 74 time steps of which 7 are a forecast</span></span>
<span><span class="co">#&gt; WARN [2023-01-18 21:47:27] testland (chain: 1): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess - </span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:28] Completed estimates for: testland</span></span>
<span><span class="co">#&gt; DEBUG [2023-01-18 21:47:28] realland: Running in exact mode for 1000 samples (across 4 chains each with a warm up of 250 iterations each) and 74 time steps of which 7 are a forecast</span></span>
<span><span class="co">#&gt; WARN [2023-01-18 21:47:50] realland (chain: 1): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span></span>
<span><span class="co">#&gt; Running the chains for more iterations may help. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#bulk-ess - </span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:51] Completed estimates for: realland</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:51] Completed regional estimates</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:51] Regions with estimates: 2</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:51] Regions with runtime errors: 0</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:51] Producing summary</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:51] No summary directory specified so returning summary output</span></span>
<span><span class="co">#&gt; INFO [2023-01-18 21:47:52] No target directory specified so returning timings</span></span></code></pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments. Each region can be estimated in parallel using the <a href="https://future.futureverse.org" class="external-link">future</a> package (when in most scenarios <code>cores</code> should be set to 1). For routine use each MCMC chain can also be run in parallel (with <code>future</code> = TRUE) with a time out (<code>max_execution_time</code>) allowing for partial results to be returned if a subset of chains is running longer than expected. See the documentation for the <a href="https://future.futureverse.org" class="external-link">future</a> package for details on nested futures.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing). Futures updated will extend the S3 methods used above to smooth access to this output.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">summarised_results</span><span class="op">$</span><span class="va">table</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="24%">
<col width="19%">
<col width="17%">
<col width="15%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left">Region</th>
<th align="left">New confirmed cases by infection date</th>
<th align="left">Expected change in daily cases</th>
<th align="left">Effective reproduction no.</th>
<th align="left">Rate of growth</th>
<th align="left">Doubling/halving time (days)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">realland</td>
<td align="left">2072 (1196 – 3680)</td>
<td align="left">Likely decreasing</td>
<td align="left">0.85 (0.61 – 1.2)</td>
<td align="left">-0.043 (-0.11 – 0.049)</td>
<td align="left">-16 (14 – -6.1)</td>
</tr>
<tr class="even">
<td align="left">testland</td>
<td align="left">2077 (1173 – 3716)</td>
<td align="left">Likely decreasing</td>
<td align="left">0.86 (0.62 – 1.2)</td>
<td align="left">-0.039 (-0.11 – 0.05)</td>
<td align="left">-18 (14 – -6.2)</td>
</tr>
</tbody>
</table>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">summary_plot</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-18-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="reporting-templates">Reporting templates<a class="anchor" aria-label="anchor" href="#reporting-templates"></a>
</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. If using these templates to report your results please highlight our <a href="https://doi.org/10.12688/wellcomeopenres.16006.1" class="external-link">limitations</a> as these are key to understanding the results from <a href="https://epiforecasts.io/EpiNow2/">EpiNow2</a> .</p>
</div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues" class="external-link">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base. We also welcome additions and extensions to the underlying model either in the form of options or improvements.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=EpiNow2" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/epiforecasts/EpiNow2/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/epiforecasts/EpiNow2/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing EpiNow2</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Joe Hickson <br><small class="roles"> Author </small>  </li>
<li>Hamada S. Badr <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-9808-2344" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Michael DeWitt <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8940-1967" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>EpiForecasts <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://www.lshtm.ac.uk/aboutus/people/funk.sebastian" class="external-link">Sebastian Funk</a> <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Joel Hellewell, Katharine Sherratt, Katelyn Gostic, Joe Hickson, Hamada S. Badr, Michael DeWitt, EpiForecasts, <a href="https://www.lshtm.ac.uk/aboutus/people/funk.sebastian" class="external-link">Sebastian Funk</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
