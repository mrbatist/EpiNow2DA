<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EpiNow2">
<title>Model definition: estimate_infections() • EpiNow2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model definition: estimate_infections()">
<meta property="og:description" content="EpiNow2">
<meta property="og:image" content="epiforecasts.io/EpiNow2/reference/figures/unnamed-chunk-14-1.png">
<meta property="og:image:alt" content="Example estimates produced by EpiNow2 of the reproduction number, cases by date of infection and cases by date of report">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@seabbs">
<meta name="twitter:site" content="@epiforecasts">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EpiNow2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.6.1000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-model-definitions">Model definitions</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-model-definitions">
    <a class="dropdown-item" href="../articles/estimate_infections.html">estimate_infections()</a>
    <a class="dropdown-item" href="../articles/estimate_secondary.html">estimate_secondary()</a>
    <a class="dropdown-item" href="../articles/estimate_truncation.html">estimate_truncation()</a>
    <a class="dropdown-item" href="../articles/gaussian_process_details.html">Gaussian Process implementation details</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-studies">Case studies</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-studies">
    <a class="dropdown-item" href="../articles/case-studies.html">External case studies and use in the literature</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiforecasts/EpiNow2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model definition: estimate_infections()</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/EpiNow2/blob/HEAD/vignettes/estimate_infections.Rmd" class="external-link"><code>vignettes/estimate_infections.Rmd</code></a></small>
      <div class="d-none name"><code>estimate_infections.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="infection-model">Infection model<a class="anchor" aria-label="anchor" href="#infection-model"></a>
</h2>
<p><code><a href="../reference/estimate_infections.html">estimate_infections()</a></code> supports a range of model
formulations. Here we describe the most commonly used and highlight
other options. The two main models for how new infections arise in the
model are a <em>renewal equation model</em> and a <em>non-mechanistic
infection model</em>. The initialisation of both of these models
involves estimating an initial infection trajectory during a
<code>seeding_time</code> <span class="math inline">\(t_\mathrm{seed}\)</span> (set to the mean of
modelled delays from infection to observation) that precedes the first
observation at time <span class="math inline">\(t=0\)</span>.</p>
<div class="section level3">
<h3 id="renewal-equation-model">Renewal equation model<a class="anchor" aria-label="anchor" href="#renewal-equation-model"></a>
</h3>
<p>This is the default model and is used when <code>rt != NULL</code>.
New infections are generated at discrete time steps of one day via the
renewal equation<span class="citation"><sup>[1]</sup></span>. These
infections are then mapped to observations via discrete convolutions
with delay distributions.</p>
<div class="section level4">
<h4 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h4>
<p>The model is initialised before the first observed data point by
assuming constant exponential growth for the mean of modelled delays
from infection to case report (called <code>seeding_time</code> <span class="math inline">\(t_\mathrm{seed}\)</span> in the model):</p>
<p><span class="math display">\[\begin{align}
  I_0  &amp;\sim \mathcal{LogNormal}(I_\mathrm{obs}, 0.2) \\
  r &amp;\sim \mathcal{Normal}(r_\mathrm{obs}, 0.2)\\
  I_{0 &lt; t \leq t_\mathrm{seed}} &amp;= I_0 \exp  \left(r t \right)
\end{align}\]</span></p>
<p>where <span class="math inline">\(I_{t}\)</span> is the number of
latent infections on day <span class="math inline">\(t\)</span>, <span class="math inline">\(r\)</span> is the estimate of the initial growth
rate, and <span class="math inline">\(I_\mathrm{obs}\)</span> and <span class="math inline">\(r_\mathrm{obs}\)</span> are estimated from the
first week of observed data: <span class="math inline">\(I_\mathrm{obs}\)</span> as the mean of reported
cases in the first 7 days (or the mean of all cases if fewer than 7 days
of data are given), divided by the prior mean reporting fraction if less
than 1 (see <a href="#delays-and-scaling">Delays and scaling</a>); and
<span class="math inline">\(r_\mathrm{obs}\)</span> as the point
estimate from fitting a linear regression model to the first 7 days of
data (or all data if fewer than 7 days of data are given),</p>
<p><span class="math display">\[\begin{equation}
log(C_t) = a + r_\mathrm{obs} t + \epsilon_t
\end{equation}\]</span> where <span class="math inline">\(C_{t}\)</span>
is the number of reported cases on day <span class="math inline">\(t\)</span>, <span class="math inline">\(a\)</span>
an estimated intercept, and <span class="math inline">\(\epsilon_{t}\)</span> the error term.</p>
</div>
<div class="section level4">
<h4 id="infections">Infections<a class="anchor" aria-label="anchor" href="#infections"></a>
</h4>
<p>For the time window of the observed data and beyond infections are
then modelled by weighting previous infections with the generation time
and scaling by the instantaneous reproduction number:</p>
<p><span class="math display">\[\begin{equation}
  I_t = R_t \sum_{\tau = 1}^{g_\mathrm{max}} g(\tau | \mu_{g},
\sigma_{g}) I_{t - \tau}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(g(\tau|\mu_{g},
\sigma_{g})\)</span> is the distribution of generation times (with
discretised gamma or discretised log normal distributions available as
options) with mean (or log mean in the case of lognormal distributions)
<span class="math inline">\(\mu_g\)</span>, standard deviation (or log
standard deviation in the case of lognormal distributions) <span class="math inline">\(\sigma_g\)</span> and maximum <span class="math inline">\(g_\mathrm{max}\)</span>. Generation times can
either be specified as coming from a distribution with uncertainty by
giving mean and standard deviations of normal priors, weighted by
default by the number of observations (although this can be changed by
the user) and truncated to be positive where relevant for the given
distribution; or they can be specified as the parameters of a fixed
distribution, or as fixed values.</p>
<p>The distribution of generation times <span class="math inline">\(g\)</span> here represents the probability that
somebody who became infectious on day 0 and who infects someone else
during their course of infection does so on day <span class="math inline">\(\tau &gt; 0\)</span>, assuming that infection
cannot happen on day 0. If not given this defaults to a fixed generation
time of 1, in which case <span class="math inline">\(R_{t}\)</span>
represents the exponential of the daily growth rate of infections.</p>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number">Time-varying reproduction number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number"></a>
</h4>
<p>Different options are available for setting a prior for <span class="math inline">\(R_t\)</span>, the instantaneous reproduction
number at time <span class="math inline">\(t\)</span>. The default prior
is an approximate zero-mean Gaussian Process (GP) for the first
differences in time on the log scale,</p>
<p><span class="math display">\[\begin{equation}
  \log R_{t} - \log R_{t-1} \sim \mathrm{GP}_t
\end{equation}\]</span></p>
<p>More details on the mathematical form of the GP approximation and
implementation are given in the <a href="https://epiforecasts.io/EpiNow2/articles/gaussian_process_details.html">Gaussian
Process implementation details</a> vignette. Other choices for the prior
of <span class="math inline">\(R_t\)</span> are available such as a GP
prior for the difference between <span class="math inline">\(R_t\)</span> and its mean value (implying that in
the absence of data <span class="math inline">\(R_t\)</span> will revert
to its prior mean rather than the last value with robust support from
the data).</p>
<p><span class="math display">\[\begin{equation}
  \log R_{t} - \log R_0 \sim \mathrm{GP}_t
\end{equation}\]</span></p>
<p>or, as a specific case of a Gaussian Process, a random walk of
arbitrary length <span class="math inline">\(w\)</span>.</p>
<p><span class="math display">\[\begin{align}
  \log R_{t \div w} &amp;\sim \mathcal{Normal} (R_{t \div (w - 1)},
\sigma_R)\\
  \sigma_R &amp;\sim \mathcal{HalfNormal}(0, 0.1)
\end{align}\]</span></p>
<p>where <span class="math inline">\(\div\)</span> indicates
interval-valued division (i.e. the floor of the division), such that for
example <span class="math inline">\(w=1\)</span> indicates a daily and
<span class="math inline">\(w=7\)</span> a weekly random walk.</p>
<p>The choice of prior for the time-varying reproduction number impact
run-time, smoothness of the estimates and real-time behaviour and may
alter the best use-case for the model.</p>
<p>The initial reproduction number <span class="math inline">\(R_{0}\)</span> has a log-normal prior with a given
log mean <span class="math inline">\(\mu_{R}\)</span> and log standard
deviation <span class="math inline">\(\sigma_{R}\)</span>, calculated
from a given mean (default: 1) and standard deviation (default: 1).</p>
<p><span class="math display">\[\begin{equation}
  R_0 \sim \mathcal{LogNormal}(\mu_R, \sigma_R)
\end{equation}\]</span></p>
<p>The simplest possible process model option is to use no time-varying
prior and rely on just the intial fixed reproduction number <span class="math inline">\(R_0\)</span>.</p>
</div>
<div class="section level4">
<h4 id="beyond-the-end-of-the-observation-period">Beyond the end of the observation period<a class="anchor" aria-label="anchor" href="#beyond-the-end-of-the-observation-period"></a>
</h4>
<p>Beyond the end of the observation period (<span class="math inline">\(T\)</span>), by default, the Gaussian process is
assumed to continue. However, here again there are a range of options.
These included fixing transmission dynamics (optionally this can also be
done before the end of the observation period), and scaling <span class="math inline">\(R_t\)</span> based on the proportion of the
population that remain susceptible. This is defined as followed,</p>
<p><span class="math display">\[\begin{equation}
    I_t = (N - I^c_{t-1}) \left(1 - \exp \left(\frac{-I'_t}{N -
I^c_{T}}\right)\right),
\end{equation}\]</span></p>
<p>where <span class="math inline">\(I^c_t = \sum_{s&lt; t} I_s\)</span>
are cumulative infections by <span class="math inline">\(t-1\)</span>
and <span class="math inline">\(I'_t\)</span> are the unadjusted
infections defined above. This adjustment is based on the one
implemented in the <code>epidemia</code> R package<span class="citation"><sup>[2]</sup></span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="non-mechanistic-infection-model">Non-Mechanistic infection model<a class="anchor" aria-label="anchor" href="#non-mechanistic-infection-model"></a>
</h3>
<p>This is an alternative model that can be used by setting
<code>rt = NULL</code> that assumes less epidemiological mechanism by
directly modelling infections on a log scale with a range of process
models. By default, this uses a Gaussian Process prior for the number of
new infections each day (on the log scale) although alternatively
infections can be estimated using a prior based on a fixed backwards
mapping of observed cases. In general, these model options will be more
computationally efficient than the renewal process model but may be less
robust due to the lack of an epidemiological process model (i.e. more
dependence is placed on the assumptions of the Gaussian process
prior).</p>
<div class="section level4">
<h4 id="initialisation-1">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation-1"></a>
</h4>
<p>In order to initialise this model, an initial estimate <span class="math inline">\(I_\mathrm{est}\)</span> of the infection
trajectory is first created by first shifting observations back in time
by <span class="math inline">\(t_\mathrm{seed}\)</span> and then
smoothing the observation data with a moving average of window size
<span class="math inline">\(z\)</span> (default: <span class="math inline">\(z=14\)</span>), allocated to the centre of the
window:</p>
<p><span class="math display">\[\begin{align}
  I_{\mathrm{est}, t \lt T - t_\mathrm{seed}} = \frac{1}{z}
\sum_{\max(-t_\mathrm{seed}, t - z/2)}^{\min(t_\mathrm{obs}, t + z/2)}
I_{\mathrm{obs}, t + t_\mathrm{seed}}
\end{align}\]</span></p>
<p>where <span class="math inline">\(T\)</span> is the day of the last
observation, <span class="math inline">\(z/2\)</span> is rounded up to
the nearest integer in the limits of the sum, and <span class="math inline">\(I_\mathrm{obs, t \lt 0} = 0\)</span>. Any date
with <span class="math inline">\(I_{\mathrm{est}, t} = 0\)</span> cases
following this procedure is then allocated 1 case to facilitate further
processing in the model.</p>
<p>For any times <span class="math inline">\(t &gt; T -
t_\mathrm{seed}\)</span> the number of infections is then estimated by
fitting an exponential curve to the final week of data and extrapolating
this until the end of the forecast horizon.</p>
</div>
<div class="section level4">
<h4 id="infections-1">Infections<a class="anchor" aria-label="anchor" href="#infections-1"></a>
</h4>
<p>By default, a Gaussian Process prior is used for the number of
infections, resulting in smoother estimates of the infection curve. In
this case, as in the renewal equation model there are two alternative
formulations available. The default uses an approximate zero-mean GP for
the differences between modelled infections and the initial
estimate,</p>
<p><span class="math display">\[\begin{equation}
  \log I_{t} - \log I_{\mathrm{est}, t} \sim \mathrm{GP}_t
\end{equation}\]</span></p>
<p>Alternatively, one can use is an approximate zero-mean Gaussian
Process (GP) for the first differences in time on the log scale,</p>
<p><span class="math display">\[\begin{equation}
  \log I_{t} - \log I_{t-1} \sim \mathrm{GP}_t
\end{equation}\]</span></p>
<p>with <span class="math inline">\(\log I_{0} - \log I_{\mathrm{est},
0} \sim \mathrm{GP}_{0}\)</span></p>
<p>More details on the mathematical form of the Gaussian process
approximation are given in the <a href="https://epiforecasts.io/EpiNow2/articles/gaussian_process_details.html">Gaussian
Process implementation details</a> vignette.</p>
<p>As for the renewal equation model, the Gaussian process can be
replaced by a random walk of arbitrary length <span class="math inline">\(w\)</span>.</p>
<p>When using a fixed shift from infections to reported cases there is
no process model and so <span class="math inline">\(I_\mathrm{est}\)</span> is used as the estimated
infection curve (potentially scaled to take into account underreporting,
see section <a href="#delays-and-scaling">Delays and scaling</a>).</p>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number-1">Time-varying reproduction number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number-1"></a>
</h4>
<p>In this model there is no prior on the time-varying reproduction
number. Instead, this is calculated from the renewal equation as a
post-processing step</p>
<p><span class="math display">\[\begin{equation}
  R_t = \frac{I_{t}}{\sum_{\tau = 1}^{g_\mathrm{max}} g(\tau | \mu_{g},
\sigma_{g}) I_{t - \tau}}
\end{equation}\]</span></p>
<p>and optionally smoothed using a centred rolling mean with a window
size that can be set by the user.</p>
</div>
<div class="section level4">
<h4 id="beyond-the-end-of-the-observation-period-1">Beyond the end of the observation period<a class="anchor" aria-label="anchor" href="#beyond-the-end-of-the-observation-period-1"></a>
</h4>
<p>Beyond the end of the observation period, by default, if using a
Gaussian process it is assumed to continue. Alternatively, incidence can
be fixed at ether the estimate at <span class="math inline">\(T\)</span>
or a less recent, more certain estimate.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="delays-and-scaling">Delays and scaling<a class="anchor" aria-label="anchor" href="#delays-and-scaling"></a>
</h2>
<p>If infections are observed with a delay (for example, the incubation
period if based on symptomatic cases, and any delay from onset to
report), they are convolved in the model to infections at the time scale
of observations <span class="math inline">\(D_{t}\)</span> using delay
distributions (with lognormal and gamma parameterisations available)
<span class="math inline">\(\xi\)</span>, scaled by an underreporting
factor <span class="math inline">\(\alpha\)</span> (which is 1 if all
infections are observed). This model can be defined mathematically as
follows,</p>
<p><span class="math display">\[\begin{equation}
  D_t = \alpha \sum_{\tau = 0}^{\xi_\mathrm{max}} \xi (\tau | \mu_{\xi},
\sigma_{\xi}) I_{t-\tau}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\xi(\tau|\mu_{\xi},
\sigma_{\xi})\)</span> is the combined discrete distribution of delays
(with discretised gamma or discretised log normal distributions
available as options) with mean (or log mean in the case of lognormal
distributions) <span class="math inline">\(\mu_\xi\)</span>, standard
deviation (or log standard deviation in the case of lognormal
distributions) <span class="math inline">\(\sigma_\xi\)</span> and
maximum <span class="math inline">\(\xi_\mathrm{max}\)</span>.</p>
<p>Delays can either be specified as coming from a distribution with
uncertainty by giving mean and standard deviations of normal priors,
weighted by the number of observations and truncated to be positive
where relevant for the given distribution; or they can be specified as
the parameters of a fixed distribution, or as fixed values.</p>
<p>The scaling factor <span class="math inline">\(\alpha\)</span>
represents the proportion of cases that are ultimately reported, which
by default is set to 1 (i.e. no underreporting) but can instead be set
to come from a normal prior with given mean and standard deviation,
truncated to be between 0 and 1.</p>
</div>
<div class="section level2">
<h2 id="observation-model">Observation model<a class="anchor" aria-label="anchor" href="#observation-model"></a>
</h2>
<p>The modelled cases <span class="math inline">\(D_{t}\)</span> are
related to observations <span class="math inline">\(C_{t}\)</span>. By
default this is assumed to follow a negative binomial distribution with
overdispersion <span class="math inline">\(\varphi\)</span>
(alternatively it can be modelled as a Poisson, in which case <span class="math inline">\(\varphi\)</span> is not used):</p>
<p><span class="math display">\[\begin{align}
  C_t &amp;\sim \mathcal{NegBinom}\left(\omega_{(t \mod n_\omega)}D_t,
\varphi\right)
\end{align}\]</span></p>
<p>where <span class="math inline">\(\omega_{t \mod n_\omega}\)</span>
is a daily reporting effect of cyclicity <span class="math inline">\(n_{\omega}\)</span>. If <span class="math inline">\(n_{\omega}=7\)</span> this corresponds to a
day-of-the-week reporting effect.</p>
<p>This model uses the following priors for the observation model,</p>
<p><span class="math display">\[\begin{align}
    \frac{\omega}{n_\omega} &amp;\sim \mathcal{Dirichlet}(1, \ldots, 1)
\\
    \frac{1}{\sqrt{\varphi}} &amp;\sim \mathcal{HalfNormal}(0, 1)
\end{align}\]</span></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-renewal" class="csl-entry">
1. Fraser, C. (2007). Estimating individual and household reproduction
numbers in an emerging epidemic. <em>PLOS ONE</em>, <em>2</em>(8), 1–12.
<a href="https://doi.org/10.1371/journal.pone.0000758" class="external-link">https://doi.org/10.1371/journal.pone.0000758</a>
</div>
<div id="ref-bhattSemiMechanisticBayesianModeling" class="csl-entry">
2. Bhatt, S., Ferguson, N., Flaxman, S., Gandy, A., Mishra, S., &amp;
Scott, J. A. (n.d.). <em>Semi-<span>Mechanistic Bayesian</span> modeling
of <span>COVID-19</span> with <span>Renewal Processes</span></em>. 14.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Joel Hellewell, Katharine Sherratt, Katelyn Gostic, Joe Hickson, Hamada S. Badr, Michael DeWitt, EpiForecasts, <a href="https://www.lshtm.ac.uk/aboutus/people/funk.sebastian" class="external-link">Sebastian Funk</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
